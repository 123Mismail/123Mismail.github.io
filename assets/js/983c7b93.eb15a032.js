"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook=globalThis.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[817],{7837(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"c5-gazebo-simulation","title":"Chapter 5: Gazebo Simulation","description":"Learning Outcomes","source":"@site/chapters/c5-gazebo-simulation.md","sourceDirName":".","slug":"/c5-gazebo-simulation","permalink":"/chapters/c5-gazebo-simulation","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"c5-gazebo-simulation","title":"Chapter 5: Gazebo Simulation","sidebar_label":"C5: Gazebo","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"C4: URDF","permalink":"/chapters/c4-urdf-robot-description"},"next":{"title":"C6: Isaac Sim","permalink":"/chapters/c6-isaac-sim"}}');var s=i(4848),r=i(8453);const t={id:"c5-gazebo-simulation",title:"Chapter 5: Gazebo Simulation",sidebar_label:"C5: Gazebo",sidebar_position:5},a="Chapter 5: Gazebo Simulation",l={},c=[{value:"Learning Outcomes",id:"learning-outcomes",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Gazebo Architecture with ROS 2",id:"gazebo-architecture-with-ros-2",level:2},{value:"Creating a Gazebo World File",id:"creating-a-gazebo-world-file",level:2},{value:"Key SDF Elements",id:"key-sdf-elements",level:3},{value:"Spawning a Robot in Gazebo",id:"spawning-a-robot-in-gazebo",level:2},{value:"Launch File Workflow",id:"launch-file-workflow",level:3},{value:"Physics Simulation Considerations",id:"physics-simulation-considerations",level:2},{value:"Inertial Properties for Stable Simulation",id:"inertial-properties-for-stable-simulation",level:3},{value:"Friction and Contact Models",id:"friction-and-contact-models",level:3},{value:"Summary",id:"summary",level:2},{value:"Review Questions",id:"review-questions",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"chapter-5-gazebo-simulation",children:"Chapter 5: Gazebo Simulation"})}),"\n",(0,s.jsx)(n.h2,{id:"learning-outcomes",children:"Learning Outcomes"}),"\n",(0,s.jsx)(n.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Configure"})," Gazebo simulation environments with custom world files and physics properties"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Spawn"})," URDF robot models in Gazebo and integrate with ROS 2 control interfaces"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Validate"})," robot behaviors in physics-based simulation before hardware deployment"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"In Module 1, we established the ROS 2 foundation: communication patterns (Topics, Actions, Services) and robot modeling (URDF). However, testing humanoid robots on physical hardware is expensive, time-consuming, and potentially dangerous. A bipedal robot executing an untested walking gait can fall and sustain damage. Manipulation algorithms require collision-free validation before operating near humans."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Gazebo"})," is a physics-based 3D robot simulator that bridges the gap between software development and hardware deployment. It simulates gravity, friction, collisions, and actuator dynamics, enabling developers to test control algorithms, sensor fusion, and navigation before deploying to real robots. For humanoid robotics, Gazebo validates balance control, joint torque limits, and multi-contact dynamics in a safe, repeatable environment."]}),"\n",(0,s.jsx)(n.p,{children:"This chapter introduces Gazebo simulation workflows integrated with ROS 2. You will create simulation worlds, spawn URDF models with physics properties, and connect Gazebo to ROS 2 control interfaces. By chapter's end, you'll understand how to use simulation as a development accelerator and safety validator."}),"\n",(0,s.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Gazebo"}),": Open-source 3D robot simulator with physics engines (ODE, Bullet, Simbody) for realistic dynamics and sensor simulation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SDF (Simulation Description Format)"}),": XML-based format for describing simulation worlds, models, sensors, and plugins in Gazebo"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"World File"}),": SDF file defining the simulation environment including lighting, terrain, obstacles, and environmental properties"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Physics Engine"}),": Computational system simulating rigid body dynamics, collisions, and constraints (ODE by default in Gazebo)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ros_gz_bridge"}),": ROS 2 package providing bidirectional communication between Gazebo topics and ROS 2 topics"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Spawn Entity"}),": Process of loading a URDF or SDF model into a running Gazebo simulation at a specified pose"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Inertial Properties"}),": Mass, center of mass, and inertia tensor required for physics-accurate simulation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Collision Geometry"}),": Simplified shapes used for contact detection and physics calculations"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"gazebo-architecture-with-ros-2",children:"Gazebo Architecture with ROS 2"}),"\n",(0,s.jsxs)(n.p,{children:["Gazebo integrates with ROS 2 through the ",(0,s.jsx)(n.code,{children:"ros_gz"})," package suite:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  ROS 2 Nodes    \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  ros_gz_bridge   \u2502\n\u2502  (Controllers,  \u2502         \u2502  (Topic/Service  \u2502\n\u2502   Planners)     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502   Translation)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                    \u2502\n                                    \u25bc\n                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                            \u2502  Gazebo Sim      \u2502\n                            \u2502  (Physics Engine,\u2502\n                            \u2502   Rendering)     \u2502\n                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"ros_gz_bridge"})," translates between Gazebo's internal topics (e.g., ",(0,s.jsx)(n.code,{children:"/model/robot/cmd_vel"}),") and ROS 2 topics (e.g., ",(0,s.jsx)(n.code,{children:"/cmd_vel"}),"), enabling seamless integration with existing ROS 2 stacks."]}),"\n",(0,s.jsx)(n.h2,{id:"creating-a-gazebo-world-file",children:"Creating a Gazebo World File"}),"\n",(0,s.jsx)(n.p,{children:"World files define the simulation environment using SDF format:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\n<sdf version="1.9">\n  <world name="humanoid_test_world">\n\n    \x3c!-- GUI camera configuration --\x3e\n    <gui>\n      <camera name="user_camera">\n        <pose>5 5 3 0 0.4 -2.35</pose>\n      </camera>\n    </gui>\n\n    \x3c!-- Directional sunlight --\x3e\n    <light type="directional" name="sun">\n      <cast_shadows>true</cast_shadows>\n      <pose>0 0 10 0 0 0</pose>\n      <diffuse>1 1 1 1</diffuse>\n      <specular>0.5 0.5 0.5 1</specular>\n      <direction>-0.5 0.1 -0.9</direction>\n    </light>\n\n    \x3c!-- Ground plane with collision --\x3e\n    <model name="ground_plane">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n              <size>100 100</size>\n            </plane>\n          </geometry>\n          <surface>\n            <friction>\n              <ode>\n                <mu>100</mu>\n                <mu2>50</mu2>\n              </ode>\n            </friction>\n          </surface>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n              <size>100 100</size>\n            </plane>\n          </geometry>\n          <material>\n            <ambient>0.8 0.8 0.8 1</ambient>\n            <diffuse>0.8 0.8 0.8 1</diffuse>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Physics engine configuration --\x3e\n    <physics name="default_physics" type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n    </physics>\n\n  </world>\n</sdf>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"key-sdf-elements",children:"Key SDF Elements"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<pose>"})}),": Position (x, y, z) and orientation (roll, pitch, yaw) in world frame"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<physics>"})}),": Simulation timestep and real-time factor (1.0 = real-time, >1.0 = faster than real-time)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<surface><friction>"})}),": Contact friction coefficients (mu = static friction, mu2 = rolling friction)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"<static>"})}),": Fixed objects that don't participate in dynamics (ground, walls)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"spawning-a-robot-in-gazebo",children:"Spawning a Robot in Gazebo"}),"\n",(0,s.jsx)(n.p,{children:"This Python launch file spawns a URDF robot model in a Gazebo world:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# spawn_robot_gazebo.launch.py\nimport os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch.actions import IncludeLaunchDescription, DeclareLaunchArgument\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n\n    # Package directories\n    pkg_ros_gz_sim = get_package_share_directory('ros_gz_sim')\n    pkg_robot_description = get_package_share_directory('my_robot_description')\n\n    # Paths to world and URDF files\n    world_file = os.path.join(pkg_robot_description, 'worlds', 'humanoid_test_world.sdf')\n    urdf_file = os.path.join(pkg_robot_description, 'urdf', 'simple_arm.urdf')\n\n    # Read URDF content\n    with open(urdf_file, 'r') as f:\n        robot_description = f.read()\n\n    # Launch Gazebo with custom world\n    gazebo_launch = IncludeLaunchDescription(\n        PythonLaunchDescriptionSource(\n            os.path.join(pkg_ros_gz_sim, 'launch', 'gz_sim.launch.py')\n        ),\n        launch_arguments={'gz_args': world_file}.items()\n    )\n\n    # Robot State Publisher node\n    robot_state_publisher = Node(\n        package='robot_state_publisher',\n        executable='robot_state_publisher',\n        name='robot_state_publisher',\n        output='screen',\n        parameters=[{'robot_description': robot_description}]\n    )\n\n    # Spawn robot entity in Gazebo\n    spawn_entity = Node(\n        package='ros_gz_sim',\n        executable='create',\n        arguments=[\n            '-name', 'simple_arm',\n            '-topic', 'robot_description',\n            '-x', '0.0',\n            '-y', '0.0',\n            '-z', '0.5'\n        ],\n        output='screen'\n    )\n\n    # ROS-Gazebo bridge for /clock topic (simulation time)\n    bridge_clock = Node(\n        package='ros_gz_bridge',\n        executable='parameter_bridge',\n        arguments=['/clock@rosgraph_msgs/msg/Clock[gz.msgs.Clock'],\n        output='screen'\n    )\n\n    return LaunchDescription([\n        gazebo_launch,\n        robot_state_publisher,\n        spawn_entity,\n        bridge_clock\n    ])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"launch-file-workflow",children:"Launch File Workflow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Load Gazebo World"}),": ",(0,s.jsx)(n.code,{children:"gz_sim.launch.py"})," starts Gazebo with the specified world file"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Publish Robot Description"}),": ",(0,s.jsx)(n.code,{children:"robot_state_publisher"})," loads URDF onto ",(0,s.jsx)(n.code,{children:"/robot_description"})," topic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Spawn Entity"}),": ",(0,s.jsx)(n.code,{children:"ros_gz_sim create"})," subscribes to ",(0,s.jsx)(n.code,{children:"/robot_description"})," and spawns the model at specified pose"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bridge Clock"}),": Synchronize ROS 2 time with Gazebo simulation time via ",(0,s.jsx)(n.code,{children:"/clock"})," topic"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"physics-simulation-considerations",children:"Physics Simulation Considerations"}),"\n",(0,s.jsx)(n.h3,{id:"inertial-properties-for-stable-simulation",children:"Inertial Properties for Stable Simulation"}),"\n",(0,s.jsx)(n.p,{children:"Gazebo requires accurate inertial properties in URDF. Incorrect values cause instability:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<inertial>\n  <mass value="0.5"/>  \x3c!-- kg --\x3e\n  <origin xyz="0 0 0.15" rpy="0 0 0"/>  \x3c!-- Center of mass offset --\x3e\n  <inertia ixx="0.002" ixy="0.0" ixz="0.0"\n           iyy="0.002" iyz="0.0" izz="0.0001"/>  \x3c!-- kg\u22c5m\xb2 --\x3e\n</inertial>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Common Issues"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Zero or very small inertia"}),": Robot links jitter or explode"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Inertia not matching geometry"}),": Unrealistic motion"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Missing ",(0,s.jsx)(n.code,{children:"<collision>"})," geometry"]}),": Links fall through ground"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"friction-and-contact-models",children:"Friction and Contact Models"}),"\n",(0,s.jsx)(n.p,{children:"Ground contact friction prevents slipping during walking gaits:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<surface>\n  <friction>\n    <ode>\n      <mu>1.0</mu>    \x3c!-- Static friction coefficient --\x3e\n      <mu2>1.0</mu2>  \x3c!-- Rolling friction coefficient --\x3e\n    </ode>\n  </friction>\n</surface>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For humanoid feet: ",(0,s.jsx)(n.code,{children:"mu \u2265 0.8"})," simulates rubber sole on concrete."]}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(n.p,{children:["Gazebo simulation provides a physics-based testing environment for humanoid robots, enabling validation of control algorithms, sensor fusion, and dynamics before hardware deployment. By creating ",(0,s.jsx)(n.strong,{children:"World files"})," (SDF environments), spawning ",(0,s.jsx)(n.strong,{children:"URDF models"})," with accurate ",(0,s.jsx)(n.strong,{children:"inertial properties"}),", and bridging communication via ",(0,s.jsx)(n.strong,{children:"ros_gz_bridge"}),", developers can iterate rapidly in simulation."]}),"\n",(0,s.jsx)(n.p,{children:"In Chapter 6, we will extend simulation capabilities with NVIDIA Isaac Sim, introducing GPU-accelerated physics, photorealistic rendering, and synthetic sensor data generation for training machine learning models."}),"\n",(0,s.jsx)(n.h2,{id:"review-questions",children:"Review Questions"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Conceptual"}),": Why is accurate inertial specification (mass, inertia tensor) critical for stable humanoid robot simulation in Gazebo?"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Applied"}),": Modify the ",(0,s.jsx)(n.code,{children:"spawn_robot_gazebo.launch.py"})," to spawn the robot at position (2.0, 1.0, 0.5) with a 45-degree yaw rotation."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Structural"}),": What is the role of ",(0,s.jsx)(n.code,{children:"ros_gz_bridge"}),", and why is it necessary for ROS 2-Gazebo integration?"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>t,x:()=>a});var o=i(6540);const s={},r=o.createContext(s);function t(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);